language: cpp
compiler: gcc
# command to install dependencies
install: 
  - curl http://epics.nsls2.bnl.gov/debian/repo-key.pub | sudo apt-key add -
  - echo "deb http://epics.nsls2.bnl.gov/debian/ wheezy main contrib" | sudo tee -a /etc/apt/sources.list
  - echo "deb-src http://epics.nsls2.bnl.gov/debian/ wheezy main contrib" | sudo tee -a /etc/apt/sources.list
  - sudo apt-get update -qq
  - sudo apt-get install epics-dev epics-synapps-dev libhdf5-serial-dev libtiff-dev
  - grep "define ASYN_[RV]E[RV]" /usr/lib/epics/include/asynDriver.h
  - cat /usr/lib/libhdf5.settings
  - echo "EPICS_BASE=/usr/lib/epics" >> configure/RELEASE.local
  - echo "HDF5=/usr" >> configure/CONFIG_SITE.linux-x86_64.Common
  - echo "HDF5_LIB=/usr/lib" >> configure/CONFIG_SITE.linux-x86_64.Common
  - echo "HDF5_INCLUDE=-I/usr/include" >> configure/CONFIG_SITE.linux-x86_64.Common
  - EPICS_BASE=/usr/lib/epics EPICS_CA_HOST_ARCH=linux-x86_64 make
# command to run tests
script:
  - ls -al lib/*
  - ls -al bin/*
  - ./bin/linux-x86_64/test_big_classic testbigclassic.cdf

